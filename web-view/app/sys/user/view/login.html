<!DOCTYPE html>
<html>
<head profile="http://www.w3.org/2005/10/profile">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel='icon' href='/favicon.ico' type='image/x-icon' />
<link rel='shortcut icon' href='/favicon.ico' type='image/x-icon' />
    <title>登录 - 然之协同</title>
<script language='Javascript'>var config={"webRoot":"\/","appName":"sys","cookieLife":30,"requestType":"GET","requestFix":"-","moduleVar":"m","methodVar":"f","viewVar":"t","defaultView":"html","themeRoot":"\/theme\/","currentModule":"user","currentMethod":"login","clientLang":"zh-cn","requiredFields":"","save":"\u4fdd\u5b58","router":"\/sys\/index.php","runMode":"front","timeout":30000,"pingInterval":60}
</script>
<link rel='stylesheet' href='../../../../css/theme/default/all.css' type='text/css' media='screen' />
<link rel='stylesheet' href='../../../../css/theme/clear/style.css' type='text/css' media='screen' />
<script src="../../../../js/jquery/min.js"></script>
<script type="text/javascript" src="../../../../js/all.js" ></script>
<style>.user-control-nav{margin-bottom: 20px;}
body {padding-top: 0;}
.page-content{padding: 0;}
.text-bold{font-weight: bold;}
.container {margin: 10% auto 0 auto}

#login {margin: 0 auto; width: 500px; min-height: 230px; background-color: #fff; border: 1px solid #dfdfdf; -moz-border-radius:3px; -webkit-border-radius:3px; border-radius:3px; -moz-box-shadow: 0px 1px 15px rgba(0,0,0,0.15); -webkit-box-shadow: 0px 1px 15px rgba(0, 0, 0, 0.15); box-shadow: 0px 1px 15px rgba(0, 0, 0, 0.15)}
#login .panel-head {min-height: 55px; background-color: #edf3fe; border-bottom: 1px solid #dfdfdf; position: relative}
#login .panel-head h4 {margin: 0 0 0 20px; padding: 0; line-height: 55px; font-size: 14px}
#login .panel-actions {float: right; position: absolute; right: 15px; top: 12px; padding: 0}
#login .panel-actions .dropdown {display: inline-block; margin-right: 2px}
#login #submit {min-width: 100px;}
#loginForm {padding: 20px 20px;}
.table-form th, .table-form td {padding: 8px 5px}
.checkbox {display: inline-block; padding-left: 80px;}

.notice {padding: 10px;}
</style><!--[if lt IE 9]>
<script src='/js/html5shiv/min.js?v=4.8' type='text/javascript'></script>
<script src='/js/respond/min.js?v=4.8' type='text/javascript'></script>
<![endif]-->
<!--[if lt IE 10]>
<script src='/js/jquery/placeholder/min.js?v=4.8' type='text/javascript'></script>
<![endif]-->
<script language='Javascript'>if(typeof(v) != "object") v = {};v.lang = {"confirmDelete":"\u60a8\u786e\u5b9a\u8981\u6267\u884c\u5220\u9664\u64cd\u4f5c\u5417\uff1f","confirmFinish":"\u60a8\u786e\u5b9a\u8981\u6267\u884c\u5b8c\u6210\u64cd\u4f5c\u5417\uff1f","deleteing":"\u5220\u9664\u4e2d","doing":"\u5904\u7406\u4e2d","timeout":"\u7f51\u7edc\u8d85\u65f6,\u8bf7\u91cd\u8bd5","confirmDiscardChanges":"\u8868\u5355\u5df2\u66f4\u6539\uff0c\u786e\u5b9a\u5173\u95ed\uff1f","yes":"\u662f","no":"\u5426"};</script>
</head>
<body class='m-user-login'>
<script src='../../../../js/md5.js' type='text/javascript'></script>
<script language='Javascript'>v.random = "63a0e5f888d02150a81dfb9a050263f4";</script>
<script language='Javascript'>v.notEncryptedPwd = false;</script>
<style>body{background-color:#f6f5f5}</style> 
<div class='container'>
  <div id='login'>
    <div class='panel-head'>
      <h4>协同管理系统</h4>
      <div class='panel-actions'>
        <div class='dropdown' id='langs'>
          <button class='btn' data-toggle='dropdown' title='Change Language/更换语言/更換語言'>简体 <span class="caret"></span></button>
          <ul class='dropdown-menu'>
                        <li class="active"><a href="###" data-value="zh-cn">简体</a></li>
                        <li class=""><a href="###" data-value="zh-tw">繁體</a></li>
                        <li class=""><a href="###" data-value="en">English</a></li>
                      </ul>
        </div>
      </div>
    </div>
    <div class="panel-body" id="loginForm">
      <form method='post' target='hiddenwin' class='form-condensed'>
        <div id='responser' class='text-center'></div>
        <div class='row'>
          <div class='col-xs-4 text-center'>
          <img src='../../../../css/theme/default/images/main/logo.png'  />
          </div>
          <div class='col-xs-8'>
            <table class='table table-form'>
              <tr>
                <th>用户名</th>
                <td><input type='text' name='account' id='account' value='' autocomplete='on' class='form-control' placeholder='请输入用户名' />
</td>
              </tr>
              <tr>
                <th>密码</th>
                <td><input type='password' name='password' id='password' value='' class='form-control' placeholder='请输入密码' />
</td>
              </tr>
              <tr>
                <th></th>
                <td>
                   <button type='submit' id='submit' class='btn btn-primary'  data-loading='稍候...'>登录</button><input type='hidden' name='referer' id='referer' value='http://demo.ranzhi.org/sys/index.php'  />
                  <label class='checkbox-inline'><input type='checkbox' name='keepLogin[]' value='on'  id='keepLoginon' /> 保持登录</label>                </td>
              </tr>
            </table>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class='notice text-center'>
  </div>
</div>
<script language='Javascript'>
$(document).ready(function()
{
    $('.form-search').submit(function()
    {
        var inputValue = $(".search-query").val();
        if(inputValue == '')
        {
            alert('请输入用户名');
            return false;
        }
    });
    
    if(v.deptID) $('#category' + v.deptID).addClass('text-bold');
})
$(document).ready(function()
{
    $('#account').focus();

    setInterval('ping()', 1000 * config.pingInterval);

    $("#langs li > a").click(function() 
    {
        selectLang($(this).data('value'));
    });

    /* show update notice. */
    if(typeof(latest) != 'undefined')
    {
        if(typeof(v.ignoreNotice) == 'undefined' || $.inArray('update' + latest.version, v.ignoreNotice) == -1)
        {
            var content = 'NOTE: <a href=' + latest.url + ' target=\'_blank\'>' + latest.note + '(' + latest.releaseDate + ')</a>';
            content += "&nbsp;&nbsp;&nbsp;<a class='ignore' href=" + createLink('misc', 'ignoreNotice', 'version=update' + latest.version) + ">" + v.ignore + "</a>";
            content = "<p>" + content + "</p>";
            $('.notice').append(content); 
        }
    }
    if(typeof(notice) != 'undefined')
    {
        if(typeof(v.ignoreNotice) == 'undefined' || $.inArray('notice' + notice.id, v.ignoreNotice) == -1)
        {
            var content = 'NOTE: <a href=' + notice.url + ' target=\'_blank\'>' + notice.note + '(' + notice.date + ')</a>';
            content += "&nbsp;&nbsp;&nbsp;<a class='ignore' href=" + createLink('misc', 'ignoreNotice', 'version=notice' + notice.id) + ">" + v.ignore + "</a>";
            content = "<p>" + content + "</p>";
            $('.notice').append(content); 
        }
    }
    $('.ignore').click(function()
    {
        $.get($(this).prop('href'));
        $(this).prop('href', '###');
        $('.notice').html('');
        return false;
    });
})

/* Keep session random valid. */
$('#submit').click(function()
{
    var password    = v.notEncryptedPwd ? $('#password').val() : md5(md5(md5($('#password').val()) + $('#account').val()) + v.random);
    var rawPassword = md5($('#password').val());
    
    loginURL = createLink('user', 'login');
    $.ajax(
    {
        contentType: 'application/x-www-form-urlencoded',
        type: "POST",
        data:"account=" + $('#account').val() + '&password=' + password + '&referer=' + encodeURIComponent($('#referer').val()) + '&rawPassword=' + rawPassword + '&keepLogin=' + $('#keepLoginon').is(':checked'),
        url:$('#ajaxForm').attr('action'),
        dataType:'json',
        success:function(data)
        {
            if(data.result == 'fail') return  bootbox.alert(data.message);
            if(data.result == 'success') return location.href=data.locate;
            if(typeof(data) != 'object') return bootbox.alert(data);
        },
        error:function(data){bootbox.alert(data.responseText)}
    })
    return false;
})

</script>

<script language='Javascript'>v.ignoreNotice = [];</script>
<script language='Javascript'>v.ignore = "\u5ffd\u7565";</script>
</body>
</html>

